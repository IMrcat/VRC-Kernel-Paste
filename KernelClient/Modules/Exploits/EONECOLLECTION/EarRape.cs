using System;
using ExitGames.Client.Photon;
using Il2CppSystem;
using KernelClient.Wrapper;
using MelonLoader;
using Photon.Pun;
using Photon.Realtime;
using UnhollowerBaseLib;
using VRC.SDKBase;

namespace KernelClient.Modules.Exploits.EONECOLLECTION
{
	// Token: 0x020000AD RID: 173
	internal class EarRape : KernelModule
	{
		// Token: 0x0600049D RID: 1181 RVA: 0x00003992 File Offset: 0x00001B92
		public override void OnUiManagerInit()
		{
			MenuSetup._uiManager.QMMenu.GetCategoryPage(PageNames.Exploits).GetCategory(CatagoryNames.EONEcollection).AddToggle("Legacy E1", "E1 Event! (Ctrl + Shift + E)", delegate(bool s)
			{
				this.voiceRape = s;
			}, false);
		}

		// Token: 0x0600049E RID: 1182 RVA: 0x0001AD68 File Offset: 0x00018F68
		public override void OnUpdate()
		{
			bool flag = !this.voiceRape;
			if (!flag)
			{
				try
				{
					byte[] bytes = BitConverter.GetBytes(PhotonNetwork.field_Public_Static_LoadBalancingClient_0.field_Private_LoadBalancingPeer_0.ServerTimeInMilliSeconds);
					byte[] bytes2 = BitConverter.GetBytes(Networking.LocalPlayer.playerId);
					Buffer.BlockCopy(bytes, 0, this._rapePacket, 4, 4);
					Buffer.BlockCopy(bytes2, 0, this._rapePacket, 0, 4);
					Il2CppStructArray<byte> il2CppStructArray = new Il2CppStructArray<byte>((long)this._rapePacket.Length);
					for (int i = 0; i < this._rapePacket.Length; i++)
					{
						il2CppStructArray[i] = this._rapePacket[i];
					}
					Object @object = il2CppStructArray.Cast<Object>();
					for (int j = 0; j < this._rapePacket.Length; j++)
					{
						il2CppStructArray[j] = this._rapePacket[j];
					}
					Object object2 = @object;
					PhotonNetwork.Method_Public_Static_Boolean_Byte_Object_RaiseEventOptions_SendOptions_0(1, object2, new RaiseEventOptions
					{
						field_Public_ReceiverGroup_0 = 1,
						field_Public_EventCaching_0 = 0
					}, default(SendOptions));
				}
				catch (Exception ex)
				{
					MelonLogger.Error(ex);
				}
			}
		}

		// Token: 0x04000322 RID: 802
		private bool voiceRape = false;

		// Token: 0x04000323 RID: 803
		private readonly byte[] _rapePacket = new byte[]
		{
			86, 0, 0, 0, 201, 60, 74, 145, 187, 134,
			59, 0, 248, 125, 232, 192, 92, 160, 82, 254,
			48, 228, 30, 187, 149, 196, 177, 215, 140, 223,
			127, 209, 66, 60, 0, 226, 53, 180, 176, 97,
			104, 4, 248, 238, 195, 125, 44, 185, 182, 68,
			94, 114, 205, 181, 150, 56, 232, 126, 247, 155,
			123, 172, 108, 98, 80, 56, 113, 89, 160, 125,
			221
		};
	}
}
